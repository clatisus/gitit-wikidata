# Contest Info

date: 2019.01.14 14:10-19:10

opentrains 6316

# Solutions

## A. The ABCD Murderer

**题目大意**：有$n\le3\times10^5$个只有小写字母组成的单词，$s_1,\cdots,s_n$，$\sum |s_i|\le3\times10^5$.每个单词可以用多次，且可以重叠，问要拼出目标串$t$（$|t|\le3\times10^5$）至少需要多少单词？

**题解**：考虑$dp[i]$为拼出前缀$i$至少需要多少单词，则最后一个单词一定是贪心的选可以放的最长的单词最优，假设这个单词长度为$l$，则$dp[i]=\min_{j\in[i-l,i)} dp[j]+1$，这个最长单词可以用`AC自动机`来求，时间复杂度$O(\sum|s_i|\sigma+|t|\log{|t|})​$.

## B. The Bridge on the River Kawaii

**题目大意**：有一个$n\le10^5$个点的无向图，$q\le10^5$次操作，每次操作可能是以下三种之一：

- 在当前没有边直接相连的两个点$u$和$v$之间添加一条边权为$w\in[0,9]$的无向边
- 断开当前有边直接相连的两个点$u$和$v$的连边
- 询问点$u$和$v$之间的最小瓶颈边，不连通输出`-1`

**题解**：枚举答案$x$，则操作`3`等价于最小的$x$满足只用边权不超过$x$的边将$u$和$v$连通。用动态树维护关于删除时间的最大生成树即可。时间复杂度$O(W(n+q)\log{(n+q)})$.

## G. Shooter Island

**题目大意**：有一个$50\times10^5$的网格图，一开始全部格子都是障碍。之后$q\le10^5$次操作，或者将一个矩形变成非障碍点，或者询问两点是否可达。

**题解**：用一个$50\times10^5$的并查集维护连通性，然后再用$50$个$10^5$的并查集当链表，每个位置开始往右最早的没有被用掉的$(x,i)\to(x,i+1)$的边。则修改的时候，枚举每一行，暴力跳链表来加这些横向的边，总的复杂度是$O(50\times10^5)$。

但是光是这些边不足以表示完整的连通性，我们在暴力跳链表的同时，维护每个位置是否为障碍，检查当前位置的上下两个邻居是否已经是非障碍点，是则加边，总的复杂度不变。同理，还要检查这一行连续一段开始位置前一个和结束位置后一个。

有一个`trick`是，如果询问的两个点即使是同一个点，如果它是障碍，也是不可达的。