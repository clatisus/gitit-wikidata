# Solution

### H. The fast reading

**题目大意**：

求满足阅读时间不超过$n\le10^9$秒的由小写字母组成的字符串个数。

读一个不为`r`的字母需要的时间固定为1秒，但读一个字母`r`的时间取决于`r`前一个字母。

$1\le A_0, A_1, \cdots, A_{26}\le10$，分别为`r`前为空，为`a`，...，为`z`的阅读时间。

**题解**:

令`f[n][x]`表示阅读时间为$n$，末尾为`x`的字符串的个数，则有$O(n\sigma^2)$的`dp`。

用矩阵来加速转移，因为$A_i\le10$，需要记录$10\times\sigma$个状态，再加一个状态记录和，但是这样复杂度为$O(1000\times\sigma^3\log{n})$。

注意到`dp[n][x]`中当`x`不为'r'的时候，它们所有的转移都是相同的，因此值也一定相同。

因此只需要$21$个状态，可以轻松跑过。

**trick**:`mod 1234567891`时加法会溢出。



