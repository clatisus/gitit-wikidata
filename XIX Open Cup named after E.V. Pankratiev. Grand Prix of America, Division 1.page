# Contest Info

date: 2019.03.19 16:14-21:14

[practice link](http://opentrains.snarknews.info/~ejudge/team.cgi?contest_id=010454)

# Solutions

## E. Monotony

**题目大意**：给定一个 $r\times c$（$1\le r, c\le 20$）的矩阵，每个位置有一个数字，它们互不相同。定义一个矩阵是好的，当且仅当它的每一行、每一列都是单调的（增减性独立）。在所有的 $(2^r-1)(2^c-1)$ 种非空子矩阵中，有多少个好的？

**题解**：枚举一个行指标集，我们对满足单调性的列来 dp。我们预处理每两列之间的增减性（用一个 $s\in [0, 2^r)$ 来表示），那么对于当前行指标集，任意两列之间的增减性可以用预处理的值 and 上指标集即可。

然后我们 dp。$\text{dp}_{i,c}$ 表示当前在第 $i$ 列，增减性为 $c$ 的方案数。转移的时候枚举 $j$，设列 $j$ 和列 $i$ 之间的增减性为 $k$。那么有 $\text{dp}_{i,k}\leftarrow \text{dp}_{i,k}+\text{dp}_{j,k}$。复杂度 $\mathcal{O}(2^r\times c^2)$。

## G. Intersecting Rectangles

签到题。

## L. Plans, Trains, but not Automobiles

**题目大意**：给定了一个 $n$（$1\le n\le 10^5$) 个点，$m$（$0\le m\le 10^5)$ 条有向边的 DAG。问你最少可以被划分为多少条链。并且还要输出，在所有取到最小值的划分方案中，所有可以作为链端点的点。

**题解**：第一个问题就是求最小链覆盖。我们求二分图匹配即可，出点向入点连边。答案即为点数减去匹配数。复杂度 $\mathcal{O}(m\sqrt n)$。

第二个问题，我们考虑一个点可以作为链的起点。那么说明如果我们删掉该点的入点，匹配数不发生改变。同理，如果一个点可以作为链的终点，那么删掉该点的出点，匹配数不发生改变。

对于未盖点，显然可以删掉。如果从一个已盖点出发，可以搜到一条到未盖点的交错路，那么我们可以把交错路上的匹配/未匹配边取反，将这个点变成未盖点。所以我们从每个未盖点出发，走交替路，将已盖点打上答案标记。复杂度 $\mathcal{O}(n+m)$。
