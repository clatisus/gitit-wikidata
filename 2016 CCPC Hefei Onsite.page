# Contest Info

date: 2017.10.11 13:15-18:15

[practice link](https://cn.vjudge.net/contest/261031)

# Solutions

## A. 传递

**题目大意**：把竞赛图 $G=(V,E)$ 的 $E$ 划分为 $E_p,E_e$，问图 $P=(V,E_p),Q=(V,E_e)$ 是否同时为传递闭包。

**题解**：如果原图存在单向三元环，那么一定不同时为传递闭包。因为 $a\rightarrow b\rightarrow c\rightarrow a$ 如果三条边全在 $E_p$ 中，那么 $P$ 不是传递闭包。不妨假设有两条边在 $E_p$ 中，$P$ 也不是传递闭包，此时另一条边（在 $E_e$ 中）的朝向其实无所谓。所以我们只需要判断 $(V,E_p\cup E_e)$ 和 $(V,E_p\cup \displaystyle E_e')$ 是否存在单向三元环即可。竞赛图中，如果有 SCC 那么就一定存在单向三元环，我们只需要对两个图尝试做拓扑排序即可。

## D. 平行四边形

**题目大意**：给定两根相交于原点的直线 $L,L'$（保证不重合），和一个点集 $S=\{s_1,\dots,s_n\}$。现在让你选择四个点 $A,A',B,B'$ 满足 $A\in L,A' \in L', B,B'\in S$。且 $AA'$ 的中点与 $BB'$ 的中点重合。最大化四边形（可能退化） $ABA'B'$ 的面积。

**题解**：我们把 $S$ 中的点都变换到 $L,L'$ 的坐标系下。假设基为 $\vec{e_1},\vec{e_2}$，那么 $B(x_1,y_1),B'(x_2,y_2)$，可得 $A(x_1+x_2,0),A'(0,y_1+y_2)$。面积为 $|\vec{AB}\times \vec{AB'}|$。可得：

$$
\begin{aligned}
|\vec{AB}\times \vec{AB'}|&=|(-x_2,y_1)\times (-x_1,y_2)|\\
&=|(-x_2\vec{e_1}+y_1\vec{e_2})\times (-x_1\vec{e_1}+y_2\vec{e_2})|\\
&=|-x_2y_2\vec{e_1}\times \vec{e_2}-y_1x_1\vec{e_2}\times \vec{e_1}|\\
&=|x_1y_1-x_2y_2|\cdot |\vec{e_1}\times \vec{e_2}|
\end{aligned}
$$

我们维护 $x_iy_i$ 的最大和最小值即可。


## G. 小R与手机 

**题目大意**：$n$个点，每个点有一个后继或者没有。$m$次操作，或者修改一个点的后继，或者询问从一个点沿着后继链走会结束在哪个点，永远不会结束输出-1.

**题解**：模板题，lct不换根维护基环树

# Dirt Replay

D: `-3` 输入太慢；式子推错了（没验证 n=1）；四舍五入用 int。。。。

E: `-1` 没清空数组，builtin popcount太慢

G: `-3` D 不相信自己的模版，瞎改