## 再探非标准型佩尔方程

设有一佩尔方程 $x^{2}-ny^{2}=k$，利用 Brahmagupta's identity 求解：$(a^{2}+nb^{2})(c^{2}+nd^{2})=(ac-nbd)^{2}+n(ad+bc)^{2}=(ac+nbd)^{2}+n(ad-bc)^{2}$。

设 $(x_{1},y_{1})$ 是 $x^{2}-ny^{2}=k$ 的最小解，$(x_{2},y_{2})$ 是 $x^{2}-ny^{2}=1$ 的解，那么 $(x_{1}^{2}-ny_{1}^{2})(x_{2}^{2}-ny_{2}^{2})=(x_{1}x_{2}+ny_{1}y_{2})^{2}-n(x_{1}y_{2}+x_{2}y_{1})^{2}=(x_{1}x_{2}-ny_{1}y_{2})^{2}-n(x_{1}y_{2}-x_{2}y_{1})^{2}=k$。从而 $(x_{1}x_{2}+ny_{1}y_{2},x_{1}y_{2}+x_{2}y_{1})$ 和 $(x_{1}x_{2}-ny_{1}y_{2},x_{1}y_{2}-x_{2}y_{1})$ 都是原方程的解。

对于 $ax^{2}-by^{2}=c$ 型的佩尔方程，改写成 $(ax)^{2}-aby^{2}=ac$ 的形式就可以了。