## 1143. Square Country 3

**题目大意**：构造一个 $n\times m$ 的矩阵，使得每行、每列、每行的和、每列的和都是完全平方数，且矩阵中元素两两不同。

**题解**：可以分别构造两个长度为 $n$ 的序列 $a$ 和 $b$，使得序列里的元素及序列的和都是完全平方数，那么 $A_{i,j}=a_{i}b_{j}$ 即满足要求。对于元素两两不同的条件要小心。

## 1150. Logarithm

**题目大意**：给出一个长度为 $n$ 且两两不同的数列 $a$，求 $\sum_{i}\sum_{j\neq i}\log_{10}(a_{i}\oplus a_{j})$。

**题解**：`trie` 入门题。

## 1171. 两个数的平方和 V2

**题目大意**：给出 $N\le10^{18}$，求出所有的整数 $0\le i\le j$，使得 $N=i^{2}+j^{2}$。

**题解**：注意到即便暴力复杂度也只有 $\mathcal{O}(10^{9})$，考虑剪枝。我们可以选取若干个质数，求出所有满足 $i^{2}+j^{2}\equiv N\pmod{p}$ 的 $i$。由于模质数意义下只有一半的数是二次剩余，所以每一个质数大约能够筛掉一半的数。

## 1184. 第N个质数

**题目大意**：求第 $n\le10^{9}$ 个质数。

**题解**：朴素的想法是二分加洲阁筛，时间复杂度是 $\mathcal{O}((n\log n)^{\frac{3}{4}})$，会稍微超时一点。但是我们可以从[wiki](https://en.wikipedia.org/wiki/Prime-counting_function#Inequalities)上找到一个质数估计函数，在本题范围下误差不超过 $\pm3\times10^{6}$。因此我们可以对 `left-1` 前用洲阁筛计数，`left~right` 用区间筛即可。

## 1245. Binomial Coefficients Revenge

**题目大意**：求 ${n\choose0},\cdots,{n\choose n}$ 中质因子 $p$ 的数量分别为 $0,1,2,\cdots$ 的有多少个。

**题解**：使用[库默尔定理](http://clatisus.com/conclusion/zhongzihao/zhongzihao#%E5%BA%93%E9%BB%98%E5%B0%94%E5%AE%9A%E7%90%86)就可以简单地转化成一个数位 $dp$ 了。

## 1261. 上升数

**题目大意**：定义前一位小于等于后一位的正整数为上升数，求 $n$ 位且能被 $k$ 整除的上升数的数量。

**题解**：经过一番转换后，可以等价于下面的问题：$10^{a_{1}}+\cdots+10^{a_{8}}\equiv9-10^{n}\pmod{9k}$，且 $0\le a_{1}\le\cdots\le a_{8}\le n$ 的数列 $a$ 有多少。显然是个 $dp$，朴素的想法只需要对 $0\sim n$ 中每个数取多少个进行 $dp$ 即可。但是 $n$ 太大，还需要注意到 $\pmod{9k}$ 下只有 $9k$ 种余数，可以分组背包 $dp$。设 $dp[i][j][k]$ 表示前 $i$ 组中取 $j$ 个数，余数为 $k$ 的方案数，转移时算一下组合数即可。最后答案为 $dp[9k][8][9-10^{n}\mod{9k}]$。

## 1334. 无穷可定义数

**题目大意**：对于所有满足 $w\nmid x$ 的正整数 $x$，定义 $f(x)=\frac{x}{x\mod{w}}$。若对于某个正整数 $x$，$f(x),f(f(x)),\cdots$ 无限嵌套下去都有定义，称 $x$ 为无穷可定义数。给出 $w$，求 $[L,R]$ 中的无穷可定义数。

**题解**：显然一个无穷可定义数嵌套若干次后模 $w$ 余 $1$，此后就不再变化。我们可以反向思考，从模 $w$ 余 $1$ 开始暴搜，每次考虑乘上一个数 $x$，判断乘上之后模 $w$ 的余数是否恰好是 $x$。这样我们每次可以得到模 $kw$ 余 $k$ 的一个形式，很容易计算。

## 1386. 双马尾机器人

**题目大意**：求 $\{1,2,\cdots,n\}-\{k\}$ 的所有子集中极大的两两互质的集合的大小的最小值。

**题解**：经典 $dp$。对于小于等于 $\sqrt{n}$ 的质数状压 $dp$，大于 $\sqrt{n}$ 的质数分组背包 $dp$。

## 1387. 移数字

**题目大意**：对一个序列有两种操作：一是把第三位的数字移到最前面，二是把最后一位的数字移到最前面。问 $1\sim n$ 的所有排列中有多少可以通过这两种操作排成升序。

**题解**：$n$ 为奇数时，两种操作都不改变逆序数的奇偶性，因此答案最多为 $\frac{n!}{2}$。下面我们证明答案为
$$
\begin{cases}
&n!&(2\mid n)\\
&\frac{n!}{2}&(2\nmid n)
\end{cases}
$$
使用第二种操作可以把整个串循环移位，使用第一种操作可以把前三位循环移位，结合一下就可以把任意三个位置循环移位。这样容易得到以下两种序列之一：$1,2,\cdots,n-1,n$ 和 $1,2,\cdots,n,n-1$。对于奇数我们就已经证明完毕了。对于偶数的第二种情况，我们把 $n-1$ 移到开头后再重复以上操作即可。

然后用这种[黑科技](/zhongzihao/bigfact)计算答案即可。

## 1553. 周期串查询

**题目大意**：给你一个数字字符组成的串，有一些区间修改，询问操作是问 $[l,r]$ 是否以 $d$ 为周期。

**题解**：字符串 `hash`，用线段树维护。

## 1569. 二项式系数的个数

**题目大意**：求满足 $0\le k\le n\le A$ 且 $p^{\alpha}\mid{n\choose k}$ 的 $(n,k)$ 的个数

**题解**：使用库默尔定理就变成一道娱乐的数位 $dp$ 题了。

时间复杂度 $\mathcal{O}(\log^{2}_{p}A)$。