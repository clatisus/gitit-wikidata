# Contest Info

date: 2018.05.27 09:00-14:15

[practice link](http://poj.openjudge.cn/campus2018/)

# Solutions
## G Synchronicity

**题目大意**：给定 $F_{p}$ 上的 $n$ 个 $D$ 维向量，给出两种操作，一种是修改某个位置上的向量，一种是给出两个区间，询问 $F_{p}^{D}$ 中能被某一个区间线性表示，而不能被另一个区间线性表示的向量数量。

**题解**：设一组向量张成的子空间为 $U$，那么能被它线性表示的向量数量即为 $p^{\dim U}$，所以显然我们只需要用一棵线段树维护区间的一组基即可。当然询问操作需要进行一下容斥，设两个区间中的向量张成的子空间分别为 $U_{1}$ 和 $U_{2}$，那么答案为 $p^{\dim U_{1}}+p^{\dim U_{2}}-2p^{\dim (U_{1}+U_{2})}$，其中 $\dim(U_{1}+U_{2})=\dim U_{1}+\dim U_{2}-\dim (U_{1}\cup U_{2})$。本题有些卡常，常数优化策略包括：

- 合并两组基时，若有一组基满秩，则合并后也必然满秩，不必再计算。
- 合并两组基时，应采用按秩合并的思路，即将秩较小的基合并到秩较大的基上，而不是暴力把两组基并到一起做高斯消元。

## J Fermat's Christmas Theorem?

**题目大意**：求 $x^{2}+y^{2}\equiv d\pmod N$ 满足 $0\le x,y<N$ 的解的数量。

**题解**：首先注意到，根据中国剩余定理，我们可以将 $N$ 质因数分解后，对每种质因子分别求出答案再乘起来即可。做法为打表找规律+分类讨论。

- $p=2$ 时
    - 若 $d\equiv 0\pmod{p^{t}}$ 或 $d\equiv p^{t-1}\pmod{p^{t}}$，答案为 $p^{t}$
    - 否则设 $d’$ 为 $d$ 除 $p$ 以外的质因子的乘积
        - 若 $d'\equiv 1\pmod 4$，答案为 $p^{t+1}$
        - 若 $d'\equiv 3\pmod 4$，答案为 $0$
- $p\equiv 1\pmod 4$ 时
    - 若 $d\equiv 0\pmod {p^{t}}$，答案为 $p^{t}+t\varphi(p^{t})$
    - 否则设 $d’$ 为 $d$ 除 $p$ 以外的质因子的乘积，设 $d=d'\cdot p^{s}$，答案为 $(s+1)\varphi(p^{t})$
- $p\equiv 3\pmod 4$ 时
    - 若 $d\equiv 0\pmod{p^{t}}$，答案为 $p^{2\lfloor\frac{t}{2}\rfloor}$
    - 否则设 $d’$ 为 $d$ 除 $p$ 以外的质因子的乘积，设 $d=d'\cdot p^{s}$
        - 若 $s\equiv 1\pmod 2$，答案为 $0$
        - 否则答案为 $(p+1)p^{t-1}$

（证明待续）

## K Digital Display for Anniversary

**题目大意**：有 $90$ 个数码管，给定初态和终态，给出 $5$ 种操作：

- 熄灭一个亮着的数码管
- 点亮一个熄灭的数码管
- 熄灭两个亮着的数码管
- 点亮两个熄灭的数码管
- 熄灭一个亮着的数码管，同时点亮另一个熄灭的数码管

问进行 $T$ 次操作**第一次**达到终态的操作序列有多少种。

**题解**：本题关键的性质是：$1\sim2$ 和 $3\sim5$ 号操作分别相当于改变一个数码管的状态和改变两个数码管的状态。设 $dp[i][j]$ 表示 $i$ 次操作后和终态相同的数码管有 $j$ 个的方案数，答案即为 $dp[T-1][1]+dp[T-1][2]$，矩阵转移即可。注意预处理 $A^{2^{k}}$ 以降低复杂度。

# Replay and Summary

## Replay

菜