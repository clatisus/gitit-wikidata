# Contest Info

date: 2019.03.07 16:25-21:25

[practice link](https://codeforces.com/gym/101208/)

# Solutions

## C. Surely You Congest

**题目大意**：无向图上，初始有 $c$ 辆车在一些位置。让你选择最多的车，使得它们一起从时刻 $0$ 开始朝着 $1$ 出发各自走某条最短路径，没有两辆车同时进入一条边。

**题解**：建出最短路径 DAG。可以发现，最短路长度不同的点互相独立，它们显然不可能同时进入同一条边。对于最短路径长度相同的点，如果它们的路径有边相交，显然也不行。所以对每种路径的点求一遍最大流。总流量最大为 $c$，所以复杂度 $\mathcal{O}(c(n+m))$。

## F. Low Power

**题目大意**：有 $n$ 个机器，每台机器有两块芯片，每块芯片需要 $k$ 块电池供电。现在给出 $2nk$ 块电池，求一种分配方案，使得所有机器的最大代价最小。每块芯片的代价为其 $k$ 块电池的最小值，机器的代价是两块芯片代价差的绝对值。

**题解**：二分答案。将所有电池排序，考虑一台机器中分别作为两块芯片代价的两块电池，它们一定在排序后数组中是相邻的。并且满足其后面的电池数量，减掉后面已用的电池数量，要大于 $2(k-1)$（可以使得它们成为最小值）。贪心从后往前找到这样的 $n$ 组即可。

## H. Матрёшка

**题目大意**：给出了 $n$ 个俄罗斯套娃的大小 $a_i$（$a_i$ 大小与 $n$ 同阶）。让你把它们合成若干个集合。最终每个集合里面的俄罗斯套娃从 $1$ 连续到某个 $m$（不同集合的 $m$ 相互独立）。操作的时候你只能合并相邻的两个集合。最小化打开套娃的总次数。

**题解**：考虑 $dp_i$ 表示前 $i$ 个套娃的答案。那么 $dp_i = \min_{j=0}^{i-1} (dp_{j} + \text{cost}(j+1,i))$。其中 $dp_j$ 要合法，且区间 $(j, i]$ 是从 $1$ 开始的连续数字。

考虑如何计算 $\text{cost}(j+1,i)$。我们区间 dp，合并两个区间的时候，计算打开套娃的次数。我们只考虑没有重复元素的合法区间，显然只有小于“两个区间最小值的最大值”的套娃才不用被打开。这个个数可以用类似计数排序的思想得到。复杂度 $\mathcal{O}(n^3)$。

## I. Pirate Chest

**题目大意**：有一个面积为 $m\times n$ 的池塘，每个位置有一个水的深度 $d_{ij}$。让你找到一个最大的长方体，其长和宽分别不超过 $a,b$（或者 $b,a$），高度任意，且满足在某个位置（池塘顶面和长方形顶面网格对网格）放下长方体之后（不倾斜），水面上升之后能严格高于长方体顶面。保证 $ab \le nm$。

**题解**：枚举长方体在 $n$ 的这一维，假设其限制是 $a$。枚举 $l, r$ 满足 $r-l+1\le a$。求出每一行在这些列 $[l, r]$ 之间的 min 值 $g_1, \dots, g_m$。假设我们选取了长度为 $y(y\le b)$ 的一段，这一段的 min 值为 $g_0$。假设此时长方体的高为 $h$。满足条件等价于：

$$
\begin{aligned}
&\frac{xyh}{nm} + g_0 > h\\
&h < \frac{nmg_0}{nm-xy}
\end{aligned}
$$

现在变量只有 $g_0$ 和 $y$，要让 $h$ 最大，发现在 $g_0$ 固定的情况下，需要 $y$ 尽可能大。显然这样 $xyh$ 也最大。所以对于每个 $g_i$ 我们用两次单调栈求出以它为最小值的区间长度，注意要与 $b$ 取 min。这样我们可以得到：

$$
h = \lfloor \frac{nmg_0-1}{nm-xy} \rfloor
$$