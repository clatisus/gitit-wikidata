# Contest Info

date: 2019.05.01 18:05-23:05

[practice link](http://opentrains.snarknews.info/~ejudge/team.cgi?contest_id=005021)

# Solutions

## A. Abbreviation

**题目大意**：给出一段文本，把其中长度两个以上的，满足首字母大写，首字母后跟若干小写字母的单词的，连续序列（相邻单词间有且仅有一个空格隔开）缩写起来输出。

**题解**：先将文本划分为单词和非单词的极长子段，然后处理一下即可。

## E. Expect to Wait

**题目大意**：有一个租车站，初始时有$B$辆车，之后按时间严格递增的顺序有$n\le10^5$个事件发生。第$i$个事件或者是在$t_i$时刻租车站的存库多出$k$辆车，或者是$t_i$时刻有$k$辆车的需求进入队列等待。每当存库和等待队列都不为空时，就会立刻消耗库存中的一辆车来满足队首，这一操作不消耗时间。定义每个需求的等待时间为它进入队列到它被满足之间的时间差，若不能被满足则为无穷大。$q\le10^5$次询问，第$i$次询问若$B=b_i$，那么总的等待时间是多少？

**题解**：将每一次供应和需求分开考虑，在所有需求都被满足的情况下，总的等待时间等于

$$
\text{供应的时刻之和} - \text{需求的时刻之和} - （\text{供应时供应数大于需求数的供应时刻之和}-\text{需求时供应数大于等于需求数的需求时刻之和}）
$$
初始时的$B$次供应的供应时刻都为零，可以不考虑它们，需要考虑的就是这$n$次事件，显然，$B$越大，它们就越可能进入后面的括号中。按事件时间扫一遍求出进入括号时的$B$的取值，然后在$B$的时间轴上维护一下增量，最后扫一遍$B$的时间轴离线回答询问即可。

时间复杂度$O(n\log{n})$.

## F. Foreign Postcards

签到题。

## J. Jenga Boom

按题意模拟即可。

## L. List of Primes

**题目大意**：将所有非空、由质数组成的集合排序，以质数的和为第一关键字，字典序为第二关键字。用 `JSON` 格式写出这个无限的序列，例如：

```
[2], [3], [2, 3], [5], [2, 5], [7], [3, 5], [2, 7], [2, 3, 5], [3, 7], [11], [2, 3, 7], [5, 7], [2, 11], [13], [2, 5, 7], ......
```

求 $[a,b]$ 这个区间的子串。（$a,b\le10^{18},b-a\le10^{5}$）

**题解**：打表可知数据范围内大约只需要 $2200$ 内的质数，总共有 $300$ 多个。我们从大到小 $dp$，求出 $dp[i][j]$ 表示所有大于等于 $i$ 的质数，和为 $j$ 的方案数及所有方案的 `JSON` 表示长度之和。预处理的复杂度为 $2200\times 400$。这个 $dp$ 数组包含了求出答案所需的所有信息。

求答案时，一种比较方便的实现方法是类似线段树的递归处理。我们先枚举质数的和，如果该和所占用的区间和 $[a,b]$ 相交，那么就递归下去计算这种情况；然后枚举第一个质数的值，如果相交，就把和减去这个质数，再递归下去枚举第二个质数。。。。。。如果枚举到和为 $0$ 的情况，就说明我们找到了一个在答案内的集合（为了知道这个集合，需要用栈将之前搜索的质数记录下来）。这一部分的复杂度是 $\mathcal{O}(b-a)$。

这样得到的子串会把开头和结尾的“半截”集合补充完整，为了得到正确的答案，我们需要计算一些偏移量，然后在这个串中再截取一下。