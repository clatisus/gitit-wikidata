# Contest Info

date: 2018.11.09 16:31-21:31

practice link: opentrains 10391

# Solutions

## A. Balance

**题目大意：**有一个 $n\times n(n\leq 50)$ 的矩阵，（吃完火锅回来困了，明天再写）

**题解：**

## B. Entanglement

**题目大意**：对于长度分别为 $n,m$ 的序列 $A,B$，定义 $n\times m$ 的矩阵 $C$ 是 $A,B$ 的 `Entanglement`，当且仅当 $C[i][j]=A[i]\lor C[i][j]=B[j]$ 对 $\forall i,j$ 成立。现在给出 $C$，求合法的 $A,B$ 的数量。

**题解**：首先注意到不同的 $C[i][j]$ 至多只能有 $n+m$ 种。判掉这种非法情况后离散化 $C$。

考虑暴搜 $A$，$A$ 确定之后合法的 $B$ 的数量就容易知道了。采取如下的策略减枝：

- 若某个 $C[i][j]\neq A[i]$，那么 $B[j]$ 就确定了。我们用这个 $B[j]$ 去 `check` 第 $i+1$ 行后的所有 $C[k][j]$，若 $C[k][j]\neq B[j]$，那么 $A[k]$ 也就确定了。这个过程中可能出现矛盾。
- 若 `check` 的过程中没有出现矛盾，那么不论 $i+1$ 行后怎么填，第 $j$ 列都不会非法。也就是说，一旦 $B[j]$ 确定且 `check` 后，这一列就不用再管了。
- 若 $B$ 已经确定，那么我们就可以直接计算 $A$ 的方案数，不用继续搜索下去了。
- 对于所有没有出现在第 $i$ 行的数字，若 $A[i]$ 填它，那么 $B$ 就唯一确定了。此时也可以直接计算。

大致能证明时间复杂度是 $\mathcal{O}(nm(n+m))$。但是怎么都找不到一个严谨的证法，这里就不写了。。。

## D. Infinite Pattern Matching

**题目大意**：把 $1\to+\infty$ 的二进制表示排成一个无限长的 $01$ 串，再给你一个 $01$ 串 $s$，问你 $s$ 在该串中最早出现的位置。

**题解**：瞎搞。枚举 $s$ 是由几个数字拼成的。

- 若 $1$ 个，那么如果 $s$ 没有前导 $0$，一定是由它本身组成最优；如果 $s$ 有前导 $0$，由它前面加上一个 $1$ 最优。
- 若 $2$ 个，枚举分界线在什么地方，那么我们就能知道这个数的后缀和前缀。要使结果最优，让前后缀重合的部分尽可能大即可。
- 若 $3$ 个以上，那么至少有一个数是完整的，枚举哪个区间是一个完整的数即可。

## I. Salaj

**题目大意**：给你一个 $n$ 个点的有向图，初始时没有边。定义一个序列 $A$ 合法，当且仅当存在一种加边的顺序，使得添加第 $i$ 条边后，强连通分量的数量为 $A_{i}$。对每个 $i\in[1,\max]$，求长度为 $i$ 的合法序列 $A$ 的数量。

**题解**：首先来研究要达到 $x$ 个强连通分量至少和至多能有多少条边。

最少的情况显然是：优先连接 $1\to2,2\to3,\cdots$，每当 $A_{i}$ 减小为 $x$ 时，就从 $n-x+1$ 往 $1$ 连一条边。因此至少需要 $n-x$ 加上反向边的数量（即 $A_{i}$ 减小的次数）。

最多的情况即为：连接所有正向边，$1$ 到 $n-x+1$ 的强连通分量中连接所有反向边，共 $\frac{n(n-1)+(n-x+1)(n-x)}{2}$ 条。

设 $dp[i][j][k]$ 表示第 $i$ 条边，有 $j$ 个强连通分量，连接了 $k$ 条反向边的方案数。根据上述限制简单转移即可。

这样的复杂度是 $\mathcal{O}(n^{5})$。注意到 $i\ge2n$ 时，下界一定能够满足，此时可以省去 $k$ 这一维。

时间复杂度 $\mathcal{O}(n^{4})$。 