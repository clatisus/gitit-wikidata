# Contest Info

date: 2018.08.18 12:00-17:00

[practice link](https://cn.vjudge.net/contest/248046)

# Solutions

## A. Advertising Strategy

**题目大意**：

有$n\le10^{18}$个人看电影，主办方准备了$2\le k\le10^5$份礼物。

第$i$天，设前$i-1$天已经看过电影的人有$b_i$个，主办方可以花费$c_i$份礼物，
让$c_i$个人提前看电影，这样一共就有$a_i = b_i + c_i$的人看了电影。

之后，第$i$天新增的看电影的人数是$\min(a_i, \lfloor\frac{n-a_i}{2}\rfloor)$.

问至少多少天可以让所有人都看过电影。

**题解**：

显然最优策略是在第一天给一部分礼物让第一批人看电影，之后在最后一天补一部分礼物让剩下的人看电影。

枚举第一天给的礼物数量，答案不会超过$O(\log{n})$，暴力计算取最优即可。

时间复杂度$O(k\log{n})$.

## C. Carpet 

**题目大意**：$n$ 个点的树，求一种方案，把每个点放入 $10^6\times 20$ 的棋盘中，使得边不相交。

**题解**：轻重链剖分，重链放在同一列，轻链依次放在下一列。注意先访问轻儿子。

## D. Decoding of Varints

签到题。

## H. Hilarious Cooking

**题目大意**：给你一个 $T$，问你是否能构造出一个长度恰为 $n$ 的非负整数数列 $\{t_{n}\}$，使得 $\sum_{i=1}^{n}t_{i}=T$，$|t_{i}-t_{i+1}|\le1$，并且该数列的一些位置已经给定。

**题解**：考虑所有的填数方案，显然所有方案可能得到的数列和一定是一个区间，我们只需要算出这个区间，然后判断 $T$ 是否在里面即可。最大值和最小值分别是在每个区间中填入形如“山峰”和“山谷”的情况下取得的。实现时有各种细节，需要注意。

## I. Infinite Gift

**题目大意**：给你 $\mathbb{Z}^{k}$ 中的 $n$ 个向量 $v_{1},\cdots,v_{n}$，对于每个 $v_{i}$ 和 $w\in\mathbb{Z}^{k}$，从 $w$ 向 $w+v_{i}$ 连一条边，保证整个空间连通。问这个图是否是一个二分图。

**题解**：因为整个空间连通，所以在这 $n$ 个向量中一定能找到整个空间的一组基。显然这个图是二分图等价于全部 $n$ 个向量在这组基下的各维坐标之和是一个奇数，使用 `bitset` 加速高消即可。

时间复杂度 $\mathcal{O}(\frac{n^{2}m}{64})$。

## J. Judging the Trick

**题目大意**：一个 $w\times h$ 的矩形中有 $n\le10^{5}$ 个三角形（都是整点），且它们的总面积之和严格小于 $wh$。找出一个不在任何三角形内的点。

**题解**：

**解法一**：二分横坐标，每次判断中线上是否有在三角形外的点，如果没有，那么它的左右两侧至少有一块满足所有三角形在它内部的总面积小于该矩形的总面积，到该矩形中继续查找即可。

时间复杂度 $\mathcal{O}(n\log n\log \frac{1}{eps})$。

**解法二**：扫描线。三角形的总面积之和严格小于 $wh$ 等价于至少有一条与 $y$ 轴平行的直线与所有三角形相交的线段长度之和小于 $h$，那么这条直线上必然有一点满足要求。容易发现，对于每个三角形，与 $y$ 轴平行的直线和它相交的线段长度与这条直线横坐标的关系可以用一个或两个分段的一次函数来表示，因此我们可以用扫描线来维护这些一次函数的和，为了方便，每次取两条扫描线的中线判断它是否满足要求。

观摩昂神的代码后发现，取总相交长度最短的中线来查找可以获得更好的精度。

时间复杂度 $\mathcal{O}(n\log n)$。

# Dirt Replay

C: `-1` 细节想错了，应该先访问轻儿子

F: `-1` W 跟 D 说了实现细节，然而 D 没好好听写错了一次

H: `-3` 写错了；算 max 的时候 r 算重了；W 发现了之后，Z 把 min 也顺便改了，然而 min 不需要改

I: `-4` 前两次 Z 猜了错误结论；W 没想到基一定有 m 个； 没有累计 cnt