# Contest Info

date: 2018.08.03 09:00-14:00

practice link: opentrains 10410

# Solutions

## F. Computing MDSST

**题目大意**：

给出一个$n\le15$个点的无向完全图，求一个最小路径和生成树，即最小化生成树上两两之间路径长度的和。

**题解**：

用`dp[x][s]`表示以$x$为根，子树中点集为$s$的最优值，转移时枚举子集即可。

时间复杂度$O(n^2\cdot3^n)$.

## G. MST with Metropolis

**题目大意**：

给出一个$n$个点$m$条边的简单无向连通图，对于每一个点$i$，求必须选与$i$相连的所有边的条件下的最小生成树。

**题解**：

先求一个全局最小生成树，之后对于每个点用`LCT`维护破圈法来找包含给定边的最小生成树，每次询问后撤消即可，时间复杂度$((n + m)\log{m})$.

## I. Sum of Squares of Occurrence Counts

**题目大意**：

给定字符串$S$，对于$S$的每个前缀$S_i$，求$S_i$所有本质不同子串在$S_i$中出现次数的平方和。

**题解**：

先建出$S$的`sam`和`parent`树，之后转化为$n$次操作，每次给一条到根的路径出现次数都`+1`，之后统计答案。

把`+1`从平方中拿出来维护增量即可，把`parent`树轻重链剖分之后线段树维护。

时间复杂度$O(n\log{n})$.