# Contest Info

date: 2018.08.20 13:00-18:00

[practice link](http://codeforces.com/gym/100917)

# Solutions

## D. dir -C

**题目大意**：

给出一个长度为$n\le10^5$的数列$1\le a_i\le10^9$，和一个正整数$1\le w\le10^9$.

求最小的正整数$l$，使得数列按大小$l$分块（只有最后一块大小可以不足$l$）后，每块的最大值加$1$的和不大于$w-1$.

**题解**：

`sparse-table`预处理后，枚举$l$暴力计算即可，$O(n\log{n})$.

## F. Find the Length

**题目大意**：

给出一个$n\le300$个点的无向图，边带权，对于每一个顶点$i$，求包含$i$的最小简单环。

**题解**：

简单环可以由$i$与$j$的直接连边，与不包含这条边的$i$到$j$的最短路组成。

先用`floyd`算法求出两两之间的最短路长度，对于点$i$，以$i$为根`dfs`建出一个最短路径树。

树上一个不与$i$直接相连的点$j$，如果在原图中存在$i$到$j$的直接连边，用最短路与这条边的和更新答案。

再枚举两个点$x$和$y$满足$lca(x,y)=i$，且原图中存在$x$到$y$的直接连边，用这两个点的最短路与这条边的和更新答案。

时间复杂度$O(n^3)$.

## H. Hierarchy

`stl`练习题。

## M. Matrix, The

**题目大意**：

求字典序第$k\le10^{18}$小的满足下列条件的$n\times n$的$01$矩阵：

- 每一行的$1$的个数在区间$[a,b]$内
- 每一列至少有一个$1$
- 每一列的$1$都是连续的

**题解**：

令三进制状态$S$记录每一列的状态，$0$表示这一列还没有放过$1$，$1$表示这一列末尾放了$1$，$2$表示这一列放过$1$但不在末尾。

令`dp[i][S]`表示考虑$i,\cdots ,n$行，开始状态为$S$的总方案数，枚举一行中合法的$01$状态进行转移即可，需要预处理一下转移。

时间复杂度$O(n\cdot2^n\cdot3^n)$，实际上这个上界远不会达到，可以通过。

# Dirt Replay