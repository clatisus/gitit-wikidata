# Contest Info

date: 2019.03.12 18:30-23:30

[practice link](https://codeforces.com/gym/101221/)

# Solutions

## E. Maze Reduction

**题目大意**：有一个迷宫中有$n\le100$个房间，第$i$间房间中有$k_i\le100$扇门，按逆时针顺序给出每扇门通往的房间。每间房间只能以门的数量来区分，同样个数的房间内部看起来没有区别，但是进入房间时的这一扇门是可以被记住的。在已知所有房间中门的信息的情况下，如果起点在房间$A$和起点在房间$B$两种情况在可以获得的信息中不可区分，就认为$A$和$B$是等价的。求所有等价类的集合。

**题解**：令$f(i,u,v)$为走了边$(u,v)$后再走$i$步可以获得的信息的`hash`值，则$f(0,u,v)=degree_v$，$f(i,u,v)=\sum f(i-1,u_i,v)\cdot base^i \pmod{mod}$，其中$i$为以$u$结尾的逆时针顺序的房间$v$的出边。对于房间$a$和$b$，首先如果度数不同，一定是不等价的，否则枚举一个偏移量$i\in[0,n)$，如果$degree_u = \sum [f(n,a,u_j)=f(v,b,v_{i+j})]$，其中$u_j$和$v_j$分别是$a$和$b$按逆时针顺序给出的门通往的房间，则是等价的。可以选择两对$(mod,base)$来减小出错的概率。时间复杂度$O(n^4)$.

## K. Surveillance

**题目大意**：给出一个长度为$n\le10^6$的环和环上的$k\le10^6$个线段，求覆盖整个环的需要的最少线段数。

**题解**：先把环拉成$2n$，然后每个点的父亲为覆盖它的线段中最大的右端点加一，如果没有则作为根。枚举点$i$，倍增找到第一个小于等于$i+n$的祖先，用深度差更新答案即可。时间复杂度$O(n\log{n})$.