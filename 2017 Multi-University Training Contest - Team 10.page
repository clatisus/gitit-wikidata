# Contest Info

date 2017.08.24 12:00-17:00

[practice link](http://acm.hdu.edu.cn/search.php?field=problem&key=2017+Multi-University+Training+Contest+-+Team+10&source=1&searchmode=source)

# Solutions

## B. Array Challenge

**题目大意**：略。

**题解**：见官方题解，感觉凑数字挺没意思的。猜到是线性递推以后可以用 BM 算法直接莽。

## C. Boring Game

**题目大意**：给你一个 $n\times n$ 的网格，每个格子中有一枚硬币，硬币的朝向以 $m$ 个矩形的方式给出（矩形内的硬币朝上）。两人轮流操作，每次操作选取一个右下角硬币朝上的矩形，把这个矩形中所有硬币翻面，不能操作者负。问先手胜还是后手胜。

**题解**：这道题需要用到 [nim积的结论](https://wiki-heynihao.icpc-camp.org/zhongzihao/conclusion#nim-积)。

根据一个显然的结论和 Tartan 定理，一个局面的 $sg$ 值等于所有朝上格子单一存在时的 $sg$ 值的 nim 和，而每个格子的 $sg$ 值等于一维情况下它的行和列分别的 $sg$ 值的 nim 积。由于全体非负整数在 nim 和和 nim 积下成一域，所以这道题我们就可以跟普通的矩形面积并一样用扫描线 + 线段树做了。一维情况下是 Ruler 博弈，第 $i$ 个格子单一朝上时的 $sg$ 值是 $\text{lowbit}(i)$。

再考虑求 $\bigoplus\limits_{i=1}^{n}\text{lowbit}(i)$。$[1,n]$ 的 $\text{lowbit}$ 中 $2^{j}$ 出现的位置为 $(2t+1)\cdot 2^j(0\leq t)$，那么出现奇数次也即 $(2\cdot (2k)+1)\cdot 2^j\leq n < (2\cdot (2k+1)+1)\cdot 2^j$。综上， $2^j$ 的个数为:
$$
\begin{cases}
\text{odd}, &(2^{j}\le (n\text{ mod }2^{j+2}) < 3\cdot 2^{j})\\
\text{even}, &(\text{others})\\
\end{cases}
$$

也就是说，有奇数个 $2^{j}$ 等价于 $n$ 的第 $j+1$ 位和第 $j$ 位有且仅有一个 $1$，故所求为 $n\oplus \lfloor\frac{n}{2}\rfloor$ 。

## D. Brother and Sister

**题目大意**：给你一个 $n$ 个点的有向图，所有点的出度为 $1$ ，和另外一个特殊的孤立点标号为 $0$ 。每次等概率在剩下的点中随机选取一个点，把这个点能走到的所有点删除，如果选到 $0$ 就结束。问期望删除了多少个点。

**题解**：设随机变量 $X_{i}=1$ 表示 $i$ 被删除， $X_{i}=0$ 表示 $i$ 未被删除，则答案为 $\sum_{i=0}^{n}E_{i}$ 。设 $S_{i}=\{能到达i的点\}\cup\{0\}$ ，$X_{i}=0$ 等价于 $S_{i}$ 中第一个被删除的点是 $0$ ， $X_{i}=1$ 等价于 $S_{i}$ 中第一个被删除的点不是 $0$ 。由于每次选点是等概率的，故 $P(X_{i}=1)=\frac{|S_{i}|-1}{|S_{i}|}$ ，故答案为 $\sum_{i=0}^{n}\frac{|S_{i}|-1}{|S_{i}|}$ 。

ps:  这道题真的很原题啊，但是 Z 居然看都没看一眼，简直智障。题目找不到了，和这题的区别在于没有特殊点 $0$ ，所以把所有点删完才结束，然后问的是选点次数的期望。那个题的答案是 $\sum_{i=1}^{n}\frac{1}{能到达i的点的个数}$ ，证明就略了。

## E. Cube Summation

**题目大意**：求一个正整数的所有划分方案的集合大小的立方和。

**题解**：首先可以很容易的用递推式 $\mathcal{O}(n\sqrt{n})$ 求出 [划分数](https://wiki-heynihao.icpc-camp.org/zhongzihao/conclusion#划分数) 。

设 $P(x)$ 表示划分数的生成函数， $\Sigma_{0}(x),\Sigma_{1}(x),\Sigma_{2}(x)$ 分别表示约数个数函数、约数和函数、约数平方和函数的生成函数。

我们先说明如果把立方和改为一次方和，答案就是 $[x^{n}](P(x)\Sigma_{0}(x))$ 。对于每个划分，它的每个元素给答案贡献了 $1$ ，考虑一个划分中的第 $i$ 个 $j$ ，它在 $\sigma_{0}(ij)$ 中恰对应了一个 $1$ ，而这个划分也恰好对应了 $p(n-ij)$ 中的一个划分（即去掉前 $i$ 个 $j$ 后的那个 $n-ij$ 的划分）。

用同样的方法考虑，一个划分中，三个不同的数给答案贡献了$6$ 倍它们个数之积，两个不同的数给答案贡献了 $3t_{1}^{2}t_{2}+3t_{1}t_{2}^{2}(t_{1},t_{2}是它们的个数)$ ，一个数给答案贡献了个数的三次方。$P(x)\Sigma_{0}^{3}(x)$ 正好贡献完了三个不同的数，给两个不同的数贡献了 $\frac{3t_{1}(t_{1}-1)}{2}\cdot t_{2}+\frac{3t_{2}(t_{2}-1)}{2}\cdot t_{1}$ ，给一个数贡献了 $\frac{t(t-1)(t-2)}{6}$(t为个数)的答案。 $3P(x)\Sigma_{0}(x)\Sigma_{1}(x)$ 给两个不同的数贡献了 $\frac{3t_{1}(t_{1}+1)}{2}\cdot t_{2}+\frac{3t_{2}(t_{2}+1)}{2}\cdot t_{1}$ ，给三个不同的数贡献了 $\frac{t(t+1)(t-1)}{2}$ 。$P(x)\Sigma_{2}(x)$ 给三个不同的数贡献了 $\frac{t(t+1)(2t+1)}{6}$ 的答案，这样正好贡献完了所有的答案，所求即为 $[x^{n}]\left(P(x)(\Sigma_{0}^{3}(x)+3\Sigma_{0}(x)\Sigma_{1}(x)+\Sigma_{2}(x))\right)$ 。

# Replay and Summary

## Replay

原来金策工业综合大学真的是朝鲜人啊，还以为是金策的粉丝们呢。

朝鲜人出题真难啊。